import{c as w}from"./index-Cfu0LHQK.js";const B="https://vhahxcmzpaxosthlorfm.supabase.co",x="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZoYWh4Y216cGF4b3N0aGxvcmZtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk2NjQwMDMsImV4cCI6MjA4NTI0MDAwM30.N7xuauIevwt0lI2jbeyQdby9vTPa20IsaqnQg2xRUWo",p=w(B,x);let s="ru";function E(){return new URLSearchParams(window.location.search).get("slug")}function k(e){var o;s=e,document.querySelectorAll(".lang-btn").forEach(i=>{i.classList.remove("active")}),(o=document.querySelector(`[data-lang="${e}"]`))==null||o.classList.add("active");const n=E();n&&I(n)}function _(e){document.title=e.meta_title||`${e.title} | MakeTrades`;const n=document.getElementById("page-description");n&&(n.content=e.meta_description||e.excerpt);const o=document.getElementById("page-keywords");o&&e.tags&&(o.content=e.tags.join(", "));const i=document.getElementById("page-canonical");i&&(i.href=`https://maketrades.space/blog-post.html?slug=${e.slug}`);const t=document.getElementById("og-title");t&&(t.content=e.title);const a=document.getElementById("og-description");a&&(a.content=e.excerpt);const l=document.getElementById("og-image");l&&(l.content=e.image_url||"https://maketrades.space/og-image.jpg");const d=document.getElementById("og-url");d&&(d.content=`https://maketrades.space/blog-post.html?slug=${e.slug}`);const g=document.getElementById("twitter-title");g&&(g.content=e.title);const c=document.getElementById("twitter-description");c&&(c.content=e.excerpt);const m=document.getElementById("twitter-image");m&&(m.content=e.image_url||"https://maketrades.space/twitter-image.jpg");const u={"@context":"https://schema.org","@type":"BlogPosting",headline:e.title,description:e.excerpt,image:e.image_url,author:{"@type":"Person",name:e.author},publisher:{"@type":"Organization",name:"MakeTrades",logo:{"@type":"ImageObject",url:"https://maketrades.space/logo.svg"}},datePublished:e.created_at,dateModified:e.updated_at,mainEntityOfPage:{"@type":"WebPage","@id":`https://maketrades.space/blog-post.html?slug=${e.slug}`}},r=document.getElementById("structured-data");r&&(r.textContent=JSON.stringify(u))}async function S(e){try{await p.rpc("increment_post_views",{post_id:e})}catch(n){console.error("Error incrementing views:",n)}}async function I(e){const n=document.getElementById("loading"),o=document.getElementById("error"),i=document.getElementById("post-content");n&&(n.style.display="block"),o&&(o.style.display="none"),i&&(i.style.display="none");try{const{data:t,error:a}=await p.from("blog_posts").select("*").eq("slug",e).eq("language",s).eq("published",!0).maybeSingle();if(a)throw a;if(!t){n&&(n.style.display="none"),o&&(o.style.display="block");return}_(t),S(t.id);const l=document.getElementById("post-title");l&&(l.textContent=t.title);const d=document.getElementById("post-excerpt");d&&(d.textContent=t.excerpt);const g=document.getElementById("post-category");g&&(g.textContent=t.category||"Статьи");const c=document.getElementById("post-date");c&&(c.textContent=new Date(t.created_at).toLocaleDateString(s==="ru"?"ru-RU":s==="en"?"en-US":s==="de"?"de-DE":s==="uk"?"uk-UA":s==="zh"?"zh-CN":"en-US",{year:"numeric",month:"long",day:"numeric"}),c.setAttribute("datetime",t.created_at));const m=document.getElementById("post-reading-time");m&&(m.textContent=`${t.reading_time||5} мин чтения`);const u=document.getElementById("post-author");u&&(u.textContent=t.author);const r=document.getElementById("post-image");r&&(r.src=t.image_url||"https://images.pexels.com/photos/6801648/pexels-photo-6801648.jpeg?auto=compress&cs=tinysrgb&w=800",r.alt=t.title);const y=document.getElementById("post-text");y&&(y.innerHTML=t.content);const f=document.getElementById("post-tags");f&&t.tags&&t.tags.length>0&&(f.innerHTML="<strong>Теги:</strong> "+t.tags.map(b=>`<span class="tag">${b}</span>`).join("")),v(t.category,t.id),n&&(n.style.display="none"),i&&(i.style.display="block")}catch(t){console.error("Error loading blog post:",t),n&&(n.style.display="none"),o&&(o.style.display="block")}}async function v(e,n){const o=document.getElementById("related-posts-grid");if(o)try{const{data:i,error:t}=await p.from("blog_posts").select("*").eq("language",s).eq("published",!0).eq("category",e).neq("id",n).order("created_at",{ascending:!1}).limit(3);if(t)throw t;if(!i||i.length===0){const a=document.querySelector(".related-posts");a&&(a.style.display="none");return}o.innerHTML=i.map(a=>`
      <a href="/blog-post.html?slug=${a.slug}" class="blog-card fade-in">
        <img src="${a.image_url||"https://images.pexels.com/photos/6801648/pexels-photo-6801648.jpeg?auto=compress&cs=tinysrgb&w=400"}"
             alt="${a.title}"
             class="blog-card-image"
             loading="lazy">
        <div class="blog-card-content">
          <h3>${a.title}</h3>
          <p>${a.excerpt}</p>
          <div class="blog-card-meta">
            <span>${a.author}</span>
            <span>•</span>
            <time datetime="${a.created_at}">
              ${new Date(a.created_at).toLocaleDateString(s==="ru"?"ru-RU":s==="en"?"en-US":s==="de"?"de-DE":s==="uk"?"uk-UA":s==="zh"?"zh-CN":"en-US")}
            </time>
          </div>
        </div>
      </a>
    `).join("")}catch(i){console.error("Error loading related posts:",i)}}function C(){document.querySelectorAll(".lang-btn").forEach(e=>{e.addEventListener("click",()=>{const n=e.getAttribute("data-lang");n&&k(n)})})}function h(){C();const e=E();if(e)I(e);else{const n=document.getElementById("error"),o=document.getElementById("loading");n&&(n.style.display="block"),o&&(o.style.display="none")}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",h):h();
